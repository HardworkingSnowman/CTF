#! /usr/bin/python
# coding=utf-8

#這是pip install pwn 來的
from pwn import *

# 下面4個是別人寫好的function，來自 https://github.com/pablocelayes/rsa-wiener-attack
# 原理: https://en.wikipedia.org/wiki/Wiener%27s_attack 這寫得很好
from Arithmetic import *
from ContinuedFractions import *
from RSAvulnerableKeyGenerator import *
from RSAwienerHacker import *


ciphertext=33866510697415901354662417251925806510006175052521623739290658418948459615498775914178036839615028605801202164491893824530087788119682191895160462303762123723811249650120690656569613531566977616297275272120280868457581510595627589716398999133553515790003318837592765931377401144567405054831355112325518030743
n=84025157204656987592141997056257331756511144434537460552283206308031607222538744463117924072898163795078616144752806781344334168482007513535783707423573462895525512962759941546768549741391640858471067693242893140208643272546772965496199519660300091276883144155805558425839485346805626218326597512381912978169
e=17037861270620973009322596378848645524089851509690225571498413546964798943807580071873507987926571229577181286107390471295372946045095104252209129010358537998038437908131732688139652010997999228304128582131537030628594146429192200585759753668901981852979421456101608418519529658461039935154618443708147827585

d=hack_RSA(e, n)
print(unhex(hex(pow(ciphertext, d, n))[2::]))