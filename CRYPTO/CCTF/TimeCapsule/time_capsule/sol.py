#coding=utf-8
import fractions


c, n, t, z = (30263951492003430418944035844723976843761515320480688994488846431636782360488888188067655841720110193942081554547272176290791213962513701884837856823209432209367951673301622535940395295826053396595886942990258678430777333636450042181585837395671842878310404080487115827773100028876775230121509570227303374672524063165714509957850966189605469484201028704363052317830254920108664916139026741331552127849056897534960886647382429202269846392809641322613341548025760209280611758326300214885296175538901366986310471066687700879304860668964595202268317011117634615297226602309205086105573924029744405559823548638486054634428L, 16801166465109052984956796702219479136700692152603640001472470493600002617002298302681832215942994746974878002533318970006820414971818787350153626339308150944829424332670924459749331062287393811934457789103209090873472485865328414154574392274611574654819495894137917800304580119452390318440601827273834522783696472257727329819952363099498446006266115011271978143149347765073211516486037823196033938908784720042927986421555211961923200006343296692217770693318701970436618066568854673260978968978974409802211538011638213976732286150311971354861300195440286582255769421094876667270445809991401456443444265323573485901383L, 6039738711082505929, 13991757597132156574040593242062545731003627107933800388678432418251474177745394167528325524552592875014173967690166427876430087295180152485599151947856471802414472083299904768768434074446565880773029215057131908495627123103779932128807797869164409662146821626628200600678966223382354752280901657213357146668056525234446747959642220954294230018094612469738051942026463767172625588865125393400027831917763819584423585903587577154729283694206436985549513217882666427997109549686825235958909428605247221998366006018410026392446064720747424287400728961283471932279824049509228058334419865822774654587977497006575152095818L)

frac_n_str = '15013 × 583 343756 982313 × 585 503197 547927 × 609 245815 680559 × 612 567235 432583 × 634 947980 859229 × 635 224892 351513 × 639 438000 563939 × 654 170414 254271 × 654 269804 672441 × 667 954470 985657 × 706 144068 530309 × 721 443717 105973 × 737 993471 695639 × 744 872496 387077 × 746 232585 529679 × 795 581973 851653 × 815 694637 597057 × 817 224718 609627 × 841 183196 554507 × 864 339847 436159 × 873 021823 131881 × 884 236929 660113 × 899 583643 974479 × 922 745965 897867 × 942 872831 732189 × 951 697329 369323 × 971 274523 714349 × 1017 566110 290559 × 1018 452110 902339 × 1025 985735 184171 × 1027 313536 626551 × 1059 774237 802229 × 1067 609726 096989 × 1070 689247 726159 × 1079 289330 417443 × 1098 516592 571807 × 1107 673252 158281 × 1108 654254 305327 × 1110 918654 474373 × 1111 516996 694389 × 1112 193819 715441'.split('×')

phi = 1
for f in frac_n_str:
  phi *= (int(''.join(f.split(' '))) - 1)

print phi


l = pow(2, pow(2, t, phi), n)
m = c ^ l ^ z
print hex(m)[2:]

