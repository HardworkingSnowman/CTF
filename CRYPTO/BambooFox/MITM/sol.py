#coding=utf-8
from pwn import *

p = 104289738528669059208364755334844034384221751041191583274615128714091715005092541702227271623379503907511308956195772313791763524822875817801219214664426072460597414699803333050946288880113942603477312728618613453908818259444247195600345874689813719565615336996019891979751157320249341518259279131698239428019
g = 781711373497495557708052952446921676390989528088850889348193734704535514807443

r = remote('bamboofox.cs.nctu.edu.tw', 30002)
B = int(r.recvuntil('Please give me your A.').split('\n')[5])

a1, a2 = 2, 3
A1, A2 = pow(g, 2, p), pow(g, 3, p)
r.sendline(str(A1))
r.sendline(str(A2))
key1 = pow(B, a1, p)
key2 = pow(B, a2, p)

cipher = int(r.recvall(1).split('\n')[-2].split(' : ')[1])

print unhex(hex(cipher ^ key1 ^ key2)[2:])
