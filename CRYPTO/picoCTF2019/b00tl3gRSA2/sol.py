#! /usr/bin/python
# coding=utf-8

#這是pip install pwn 來的
from pwn import *

# 下面4個是別人寫好的function，來自 https://github.com/pablocelayes/rsa-wiener-attack
# 原理: https://en.wikipedia.org/wiki/Wiener%27s_attack 這寫得很好
from Arithmetic import *
from ContinuedFractions import *
from RSAvulnerableKeyGenerator import *
from RSAwienerHacker import *

cipher = 52836234296467374804928014733285900038131079022428164697627204890875784212523320993187055854298961326800284599608101587908823316722419723605537546315681236703628956629064037912946164289999702604780856605425188561773623627952323470614985379354376182298183471968713674593579577385448077864872190890825993154774
n = 107282375083503993407607225861214849236430044238104170683559177272330320593713107695903967015471829585612530815283237906993595190207884664950147305695991080846757557895939762848632605277071930018397004897527277293225518957005001415989575483995505076888940592832962339746845836237639920389167165176432876843259
e = 31711463297337982518152603558042846932391211330707142445975683691953903452117282180829938035365065272021696857556294684442069762496103601468090599294180978785474388654277004111100635736481982208188872327091518022151938547344475757777098690820170021806132803258681134620312712914708285617508934290050109887969

d=hack_RSA(e, n)
print d
print(unhex(hex(pow(cipher, d, n))[2::]))
